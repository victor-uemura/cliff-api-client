# Step 3: takes location messages and only takes those with keywords indicating they are useful to their location.

from cliff.api import Cliff
import pandas as pd

keywords = [' area ', ' folks in ', 'a bit north ', 'a chapter in ', 'a group here in ', 'a house in ', 'a meet in ', 'a trip to ', 'active chapter in ', 'actually were in ', 'all of us are in ', 'also from ', 'also live in ', 'and from ', 'any contacts in ', 'any movement in ', 'are there any ', 'are you a ', 'are you alone in ', 'are you and your friends in ', 'are you currently in ', 'are you from', 'are you from ', 'are you in ', 'away from ', 'based in ', 'be people from from ', 'being from ', 'book clubs in ', 'born and raised in ', 'born in ', 'bought some land in ', 'branch in the ', 'can meet in ', 'catch up for a beer ', 'certain projects in ', 'chapter in ', 'chapter leader for ', 'chapters in ', 'charges in ', 'cheers from', 'collaborating with some ', 'college in ', 'community in ', 'considered moving to ', 'coordinate contacting your ', 'crew from', 'currently live in', 'currently living ', 'currently located in ', 'demonstration in ', 'do you be in ', 'do you do in ', 'do you have ', 'do you know ', 'do you live in ', 'doing in the ', 'end up in ', 'family comes from ', 'fascists in ', 'friend in ', 'friends are in ', 'friends from ', 'from coast to coast in ', 'from the ', 'gathering in ', 'get a place in ', 'get down to ', 'going to be in ', 'going to stay ', 'going to the ', 'going to the beach in ', 'going well for you in ', 'good lads up here', 'got back from ', 'greetings from ', 'greetings sir', 'grew up in ', 'groups in ', 'guys here in ', 'guys in ', 'hail from ', 'have a location in ', 'have some relatives in ', 'he goes to school ', 'he lives ', "he's based ", 'heil from ', 'here in ', 'hitting up the ', 'hope to visit', 'hope visit', 'hours away ', 'hours from ', 'hours in ', 'how are things in ', 'how is ', 'i am a ', 'i am also from ', 'i am currently in ', 'i am from', 'i am going to travel', 'i am in ', 'i am located', 'i am studying', 'i am travelling', 'i can come to ', 'i come back from ', 'i come from ', 'i get here in ', 'i go on a holiday ', 'i got to college in ', 'i grew up ', 'i had going in ', 'i live ', 'i live in ', 'i live outside ', 'i lived in ', 'i met him ', 'i met in ', 'i myself live in ', 'i reside ', 'i studied at ', 'i studied in ', 'i was in ', 'i was just in ', 'i was raised in', 'i was working at ', 'i went to ', 'i will be arriving in ', 'i will be in ', 'i will meet you ', 'i will see about ', "i'll be ", "i'll be in ", "i'll be staying ", "i'm actually from", "i'm also", "i'm currently in ", "i'm down in ", "i'm from", "i'm in ", "i'm located", "i'm moving", "i'm on ", "i'm practically in ", "i've been in ", 'if you are ever in ', 'if you get posted ', 'im from', 'im helping ', 'im in ', 'im located', 'im the most active in ', 'in getting with the ', 'interested in starting', 'interested in the ', 'is either in ', 'is still in ', 'is your family from', 'joining up with', 'just in ', 'live here ', 'live in', 'live just outside of ', 'lives in ', 'living in ', 'living just outside', 'local fascist groups in ', 'located in ', 'looking to make a connection in ', 'meet in ', 'meet up ', 'meet ups ', 'meeting in ', 'meeting up ', 'meetup', 'meetups', 'met in ', 'met with your lot in ', 'minutes away from ', 'more guys in ', 'move back', 'move far away to ', 'move to ', 'movements within ', 'moving out of ', 'moving to', 'moving to ', 'my family', 'my family is from ', 'my guys in ', 'my mom lived in ', 'my parents', 'my university', 'national action in the ', 'near me ', 'of us in ', 'operating in ', 'organisation in ', 'organizing a convention', 'originally from ', 'our own group here in ', 'our representative in ', 'over from', 'people from ', 'people in ', 'place in ', 'place to live', 'planning to visit', 'presence in ', 'regards from ', 'relocating to ', 'reside in ', 'school in ', 'searching for groups in ', 'set up something in ', 'some guys in ', 'some people in the ', 'someone in ', 'spread my ideas in ', 'started in ', 'stationed in ', 'stayed in ', 'staying in ', 'still active in ', 'still in ', 'stuck in ', 'student from', 'student from ', 'studying in ', 'thanks from', 'the eyl in ', 'the members in ', 'the other members are in ', 'there are a few ', "there's other fascists", 'things like that in ', 'things to do in ', 'to move to ', 'too many people here', 'travelling to ', 'university in ', 'wanna visit ', 'want to go to ', 'was in ', 'we have a group', 'we have a member', 'we have branches in ', 'we have folks in ', 'we have members in ', 'we live in ', 'we were in ', "we'll meet ", "we're all white in ", "we're in ", "we're up in ", 'welcome to ', 'what city in ', 'what part of ', 'when were you ', 'where about', 'where are you in ', 'where do you live ', 'where i currently live ', 'where in ', 'will be stuck in ', 'will land in ', 'will probably live ', 'will then move ', 'will you stay in ', 'with you in ', 'work in the ', 'you are from', 'you are in ', 'you from', 'you in ', 'you live in ', 'you really from ', 'you should go to', 'you should move ', 'you were in ', "you're from", "you're from ", "you're going to ", "you're in ", "you're located in ", "you're looking to get involved ", 'your in ', 'your stay in ', 'youre from', 'youre in ']
file_name = "../processedData/targeted_messages.xlsx" # path to file + file name
sheet =  "Sheet1" # sheet name or sheet number or list of sheet numbers and names

df = pd.read_excel(io=file_name, sheet_name=sheet)
excel_data = []
for index, row in df.iterrows():
  if (any(word in row['message'].lower() for word in keywords)) or (len(row['message'].split()) < 4):
    temp_data = row
    for word in keywords:
      if word in row['message'].lower():
        temp_data['reason'] = word
        break
    excel_data.append(temp_data)

excel_frame = pd.DataFrame(excel_data)
excel_frame.to_excel("../processedData/final_targeted_messages.xlsx", index=False)  